(()=>{var e={};e.id=8942,e.ids=[8942],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},15079:(e,r,a)=>{"use strict";a.d(r,{bq:()=>m,eb:()=>u,gC:()=>p,l6:()=>n,s3:()=>c,yv:()=>x});var s=a(60687),t=a(43210),d=a(91413),i=a(78272),l=a(13964),o=a(4780);let n=d.bL,c=d.YJ,m=t.forwardRef(({className:e,children:r,...a},t)=>(0,s.jsxs)(d.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:[r,(0,s.jsx)(i.A,{className:"h-4 w-4 opacity-50"})]}));m.displayName=d.l9.displayName;let p=t.forwardRef(({className:e,children:r,position:a="popper",...t},i)=>(0,s.jsx)(d.ZL,{children:(0,s.jsx)(d.UC,{ref:i,className:(0,o.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...t,children:(0,s.jsx)(d.LM,{className:(0,o.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r})})}));p.displayName=d.UC.displayName;let u=t.forwardRef(({className:e,children:r,...a},t)=>(0,s.jsxs)(d.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm text-gray-900 outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(d.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),(0,s.jsx)(d.p4,{children:r})]}));u.displayName=d.q7.displayName;let x=t.forwardRef(({className:e,children:r,...a},t)=>(0,s.jsx)(d.WT,{ref:t,className:(0,o.cn)("text-sm text-gray-900",e),...a,children:r}));x.displayName=d.WT.displayName},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},50354:(e,r,a)=>{Promise.resolve().then(a.bind(a,65704))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58722:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>x});var s=a(60687),t=a(43210),d=a(27605),i=a(63442),l=a(45880),o=a(29523),n=a(89667),c=a(15079),m=a(94e3),p=a(52581);let u=l.Ik({username:l.Yj().min(3,"Username must be at least 3 characters"),email:l.Yj().email("Invalid email address"),password_hash:l.Yj().min(6,"Password must be at least 6 characters"),role_id:l.Yj().min(1,"Role is required")});function x(){let[e,r]=(0,t.useState)(!1),[a,l]=(0,t.useState)([]),[x,h]=(0,t.useState)(null),[g,y]=(0,t.useState)([]),[f,b]=(0,t.useState)(""),[j,k]=(0,t.useState)(""),[v,w]=(0,t.useState)([]),[N,_]=(0,t.useState)(!1),{register:S,handleSubmit:P,formState:{errors:q},reset:C,setValue:R}=(0,d.mN)({resolver:(0,i.u)(u)}),U=async e=>{r(!0);try{let r;let a={username:e.username,email:e.email,role_id:parseInt(e.role_id),updated_at:new Date().toISOString()};if(e.password_hash?.trim()&&(a.password_hash=e.password_hash),!(r=x?await fetch(`/api/user?user_id=${x.user_id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}):await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,created_at:new Date().toISOString()})})).ok){let e=await r.json();throw Error(e.error||"Failed to save user")}await r.json(),p.oR.success(x?"User updated successfully":"User created successfully"),C(),b(""),h(null)}catch(e){console.error("Submission error details:",e),p.oR.error(e.message||"Failed to save user")}finally{r(!1)}},A=async()=>{if(!j.trim()){p.oR.info("Please enter a search term");return}_(!0);try{let e=await m.A.get(`/users?username=ilike.*${j}*`);w(e.data),0===e.data.length&&p.oR.info("No users found")}catch(e){console.error("Search error:",e),p.oR.error("Failed to search users")}finally{_(!1)}},E=e=>{h(e),b(e.role_id.toString()),C({username:e.username,email:e.email,password_hash:"",role_id:e.role_id.toString()}),window.scrollTo({top:0,behavior:"smooth"})},M=async e=>{if(confirm("Are you sure you want to delete this user?"))try{await m.A.delete(`/users?user_id=eq.${e}`),p.oR.success("User deleted successfully"),w(r=>r.filter(r=>r.user_id!==e)),x?.user_id===e&&(h(null),C(),b(""))}catch(e){console.error("Delete error:",e),p.oR.error("Failed to delete user")}};return(0,s.jsxs)("div",{className:"container mx-auto p-6 space-y-8",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6 dark:bg-gray-800 dark:border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:x?"Edit User":"Create User"}),(0,s.jsxs)("form",{onSubmit:P(U),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Username"}),(0,s.jsx)(n.p,{...S("username"),placeholder:"Enter username",className:"dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),q.username&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:q.username.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Email Address"}),(0,s.jsx)(n.p,{...S("email"),type:"email",placeholder:"Enter email address",className:"dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),q.email&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:q.email.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Password"}),(0,s.jsx)(n.p,{...S("password_hash"),type:"password",placeholder:"Enter password (min. 6 characters)",className:"dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),q.password_hash&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:q.password_hash.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Role"}),(0,s.jsxs)(c.l6,{value:f,onValueChange:e=>{b(e),R("role_id",e)},children:[(0,s.jsx)(c.bq,{className:"w-full dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200",children:(0,s.jsx)(c.yv,{placeholder:"Select a role"})}),(0,s.jsx)(c.gC,{className:"dark:bg-gray-800 dark:border-gray-700",children:g.map(e=>(0,s.jsx)(c.eb,{value:e.role_id.toString(),className:"dark:text-gray-200 dark:focus:bg-gray-700",children:e.role_name},e.role_id))})]}),q.role_id&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:q.role_id.message})]}),(0,s.jsx)(o.$,{type:"submit",disabled:e,className:"w-full dark:bg-primary dark:hover:bg-primary-dark",children:e?"Saving...":x?"Update User":"Create User"})]})]})}),(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6 dark:bg-gray-800 dark:border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Available Roles"}),(0,s.jsx)("div",{className:"space-y-3 text-sm dark:text-gray-300",children:g.map(e=>(0,s.jsxs)("div",{className:"border-b dark:border-gray-700 pb-2 last:border-0",children:[(0,s.jsx)("p",{className:"font-medium",children:e.role_name}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e.description})]},e.role_id))})]})})]}),(0,s.jsxs)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6 dark:bg-gray-800 dark:border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"Search Users"}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(n.p,{value:j,onChange:e=>k(e.target.value),placeholder:"Search users by username...",className:"dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",onKeyPress:e=>"Enter"===e.key&&A()})}),(0,s.jsx)(o.$,{onClick:A,disabled:N,className:"dark:bg-primary dark:hover:bg-primary-dark",children:N?"Searching...":"Search"})]}),(0,s.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,s.jsxs)("div",{className:"flex justify-between items-center p-4 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.username}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Role: ",g.find(r=>r.role_id===e.role_id)?.role_name||"Unknown"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.$,{variant:"outline",onClick:()=>E(e),className:"dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-700",children:"Edit"}),(0,s.jsx)(o.$,{variant:"danger",onClick:()=>M(e.user_id),className:"dark:bg-red-900 dark:hover:bg-red-800",children:"Delete"})]})]},e.user_id))})]})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65704:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>s});let s=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Projects\\\\fxWMS\\\\React\\\\admin-portal\\\\src\\\\app\\\\admin\\\\user\\\\createUser\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Projects\\fxWMS\\React\\admin-portal\\src\\app\\admin\\user\\createUser\\page.tsx","default")},70440:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>t});var s=a(31658);let t=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83408:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>n});var s=a(65239),t=a(48088),d=a(88170),i=a.n(d),l=a(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(r,o);let n={children:["",{children:["admin",{children:["user",{children:["createUser",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,65704)),"C:\\Projects\\fxWMS\\React\\admin-portal\\src\\app\\admin\\user\\createUser\\page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"C:\\Projects\\fxWMS\\React\\admin-portal\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Projects\\fxWMS\\React\\admin-portal\\src\\app\\admin\\user\\createUser\\page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/admin/user/createUser/page",pathname:"/admin/user/createUser",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},83997:e=>{"use strict";e.exports=require("tty")},89667:(e,r,a)=>{"use strict";a.d(r,{p:()=>t});var s=a(60687);let t=a(43210).forwardRef(({...e},r)=>(0,s.jsx)("input",{ref:r,...e}));t.displayName="Input"},94735:e=>{"use strict";e.exports=require("events")},97210:(e,r,a)=>{Promise.resolve().then(a.bind(a,58722))}};var r=require("../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),s=r.X(0,[4447,8273,1658,7605,2095,2105,5668,8263],()=>a(83408));module.exports=s})();